describe("Ext.dom.Query",function(){var C=Ext.getBody().dom,G=false,E=['<div id="a:b" class="myclass">abc</div>','<div id="c:last-child" class="myotherclass and-another-class">def</div>','<div id="abc:" specialAttr="jkl\\\\tasdf">ghi</div>','<div id="nn" class="cls:hover">jkl\\tasdf</div>','<div id="12345">mno:pqr</div>','<div id="--abc" customAttr="12345678">pqr</div>','<div id="\\nn" customAttr="myval:ue\t">stu</div>','<div id="n\\nn" customAttr="my\\tvalue">vwx</div>','<div id="oddClass" class="#odd-class-name"></div>','<div id="\nn">yz</div>',('<div id=":id"><span id=":only-child-span">some more text</span><div id="n6e">asdf</div><div id="n6g">asdf</div></div>'),('<span id="myspan" class="myclass isSpan"><span id="AAA" class="beginning">some</span><span id="BBB" class="ending">text</span></span>')],D=E.join(""),F,A;function B(H,I){return G?F.querySelectorAll(H):Ext.dom.Query.jsSelect(H,I)}beforeEach(function(){F=document.createElement("div");F.innerHTML=D;F.id="elemNode";C.appendChild(F);A=B("#myspan",F)[0]});afterEach(function(){if(F){C.removeChild(F);F=A=null}});describe("jsSelect",function(){it("should throw error for an invalid query",function(){try{var I=Ext.dom.Query("$#@$%",F);expect(false).toBe(true)}catch(H){}});describe("Standard CSS Selectors",function(){it("should locate elements by id",function(){var I=B("#nn",F),H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[3]);I=B("span > span#BBB",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(A.childNodes[1]);I=B("span + span#BBB",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(A.childNodes[1]);if(G){I=B("#\\31 2345 + div",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[5])}else{I=B("#12345 + div",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[5])}});it("should locate elements by class",function(){var I=B(".myclass",F),H=I.length;expect(H).toBe(2);expect(I[0]).toBe(F.childNodes[0]);expect(I[1]).toBe(A);I=B(" .isSpan",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(A);I=B(".isSpan .ending",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(A.childNodes[1]);I=B(".isSpan span.ending",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(A.childNodes[1])});it("should find elements by pseudo class",function(){var I=B(":last-child",F),H=I.length;expect(H).toBe(3);expect(I[1]).toBe(A);expect(I[2]).toBe(A.childNodes[1]);I=B(":first-child",F);H=I.length;expect(H).toBe(3);expect(I[0]).toBe(F.childNodes[0]);I=B("#myspan :first-child",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(A.childNodes[0]);I=B("span:last-child",F);H=I.length;expect(H).toBe(2);expect(I[0]).toBe(A);I=B("span :last-child",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(A.childNodes[1]);if(!G){I=B("div:contains(abc)",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[0])}});it("should find elements by attribute value",function(){var I=B('div[customAttr="12345678"]',F),H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[5]);I=B("div[customAttr]",F),H=I.length;expect(H).toBe(3);expect(I[0]).toBe(F.childNodes[5]);expect(I[1]).toBe(F.childNodes[6]);expect(I[2]).toBe(F.childNodes[7])})});describe("CSS Escape Sequences",function(){it("should handle escapes sequences for IDs",function(){var I=B("#\\00006en",F),H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[3]);I=B("#\\006e\\00036g",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[10].childNodes[2]);I=B("#\\006e\\00036 e",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[10].childNodes[1]);I=B("#\\6e \\6e ",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[3]);I=B("#\\6e\\6e ",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[3]);I=B("#\\6e  \\6e ",F);H=I.length;expect(H).toBe(0);I=B("#\\6e \\6e",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[3]);I=B("#\\--abc ",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[5]);I=B("#\\\\nn",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[6]);I=B("#n\\\\nn",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[7]);I=B("#a\\00003ab",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[0]);I=B("#a\\:b",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[0]);I=B("#a\\3a b",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[0]);I=B("#c\\:last-child",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[1]);I=B("#\\nn",F);H=I.length;expect(H).toBe(1);expect(I[0]).toEqual(F.childNodes[3]);I=B("div#a\\:b + div",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[1]);I=B("div#abc\\3a  + div",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[3]);I=B("#nn",F);H=I.length;expect(H).toBe(1);expect(I[0]).toEqual(F.childNodes[3]);I=B("div + div#\\--abc",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[5])});it("should handle escape sequences for class names",function(){var I=B("div.\\#odd-class-name",F),H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[8]);I=B(".\\#odd-class-name",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[8]);I=B(".cls\\3a hover",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[3])});it("should handle escape sequences for psuedos",function(){var I=B("#\\:id :first-child",F),H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[10].childNodes[0]);if(!G){I=B("div:contains(mno\\:pqr)",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[4]);I=B("div:contains(jkl\\\\\\tasdf)",F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[3])}});it("should handle escape sequences for attributes",function(){var I,H;if(Ext.isFF3_6){I=B('div[customAttr="myval\\3a ue"]',F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[6]);I=B('div[customAttr="myval:ue"]',F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[6]);I=B('div[customAttr="myval\\:ue"]',F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[6])}else{I=B('div[customAttr="myval\\3a ue\t"]',F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[6]);I=B('div[customAttr="myval:ue\t"]',F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[6]);I=B('div[customAttr="myval\\:ue\t"]',F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[6])}I=B('div[customAttr="my\\\\tvalue"]',F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[7]);I=B('div[specialAttr="jkl\\\\\\\\tasdf"]',F);H=I.length;expect(H).toBe(1);expect(I[0]).toBe(F.childNodes[2])})});describe("XML",function(){describe("selecting elements with namespace prefixes",function(){var H;beforeEach(function(){var I=["<a>",'<x:b xmlns:x="xns">x1</x:b>','<y:b xmlns:y="yns">y1</y:b>','<x:b xmlns:x="xns">x2</x:b>','<y:b xmlns:y="yns">y2</y:b>',"</a>"].join("");if(typeof DOMParser!="undefined"){H=(new DOMParser()).parseFromString(I,"application/xml")}else{H=new ActiveXObject("Microsoft.XMLDOM");H.async=false;H.loadXML(I)}});it("should select elements with namespace prefixes using the '|' namespace selector",function(){var J=B("x|b",H),I=B("y|b",H);expect(J.length).toBe(2);expect(I.length).toBe(2);expect(J[0].firstChild.nodeValue).toBe("x1");expect(J[1].firstChild.nodeValue).toBe("x2");expect(I[0].firstChild.nodeValue).toBe("y1");expect(I[1].firstChild.nodeValue).toBe("y2")});it("should select elements with namespace prefixes using the undocumented escaped colon method",function(){var J=B("x\\:b",H),I=B("y\\:b",H);expect(J.length).toBe(2);expect(I.length).toBe(2);expect(J[0].firstChild.nodeValue).toBe("x1");expect(J[1].firstChild.nodeValue).toBe("x2");expect(I[0].firstChild.nodeValue).toBe("y1");expect(I[1].firstChild.nodeValue).toBe("y2")})});describe("selecting attributes with non-word characters",function(){var H;beforeEach(function(){var I=["<a>",'<b att.name-part="x1">x1</b>',"</a>"].join("");if(typeof DOMParser!="undefined"){H=(new DOMParser()).parseFromString(I,"application/xml")}else{H=new ActiveXObject("Microsoft.XMLDOM");H.async=false;H.loadXML(I)}});it("should select attributes non-word characters '.' and '-'",function(){var I=B("b @att.name-part",H);expect(I.length).toBe(1);expect(I[0].firstChild.nodeValue).toBe("x1")})})})})});