Ext.define("Ext.ux.ajax.SimManager",{singleton:true,requires:["Ext.data.Connection","Ext.ux.ajax.SimXhr","Ext.ux.ajax.Simlet","Ext.ux.ajax.JsonSimlet"],defaultType:"basic",delay:150,ready:false,constructor:function(){this.simlets={}},getSimlet:function(A){var B=this,C=A.indexOf("?");if(C<0){C=A.indexOf("#")}if(C>0){A=A.substring(0,C)}return B.simlets[A]||B.defaultSimlet},getXhr:function(C,A,B,D){var E=this.getSimlet(A);if(E){return E.openRequest(C,A,B,D)}return null},init:function(A){var B=this;Ext.apply(B,A);if(!B.ready){B.ready=true;if(!("defaultSimlet" in B)){B.defaultSimlet=new Ext.ux.ajax.Simlet({status:404,statusText:"Not Found"})}B._openRequest=Ext.data.Connection.prototype.openRequest;Ext.data.Connection.override({openRequest:function(D,C,F){var E=!D.nosim&&B.getXhr(C.method,C.url,D,F);if(!E){E=this.callParent(arguments)}return E}});if(Ext.data.JsonP){Ext.data.JsonP.self.override({createScript:function(C,G,D){var F=Ext.urlAppend(C,Ext.Object.toQueryString(G)),E=!D.nosim&&B.getXhr("GET",F,D,true);if(!E){E=this.callParent(arguments)}return E},loadScript:function(C){var D=C.script;if(D.simlet){D.jsonpCallback=C.params[C.callbackKey];D.send(null)}else{this.callParent(arguments)}}})}}return B},openRequest:function(B,A,C){var D={method:B,url:A};return this._openRequest.call(Ext.data.Connection.prototype,{},D,C)},register:function(C){var B=this;B.init();function A(E){var D=E;if(!D.isSimlet){D=Ext.create("simlet."+(D.stype||B.defaultType),E)}B.simlets[E.url]=D;D.manager=B}if(Ext.isArray(C)){Ext.each(C,A)}else{if(C.isSimlet||C.url){A(C)}else{Ext.Object.each(C,function(D,E){E.url=D;A(E)})}}return B}});